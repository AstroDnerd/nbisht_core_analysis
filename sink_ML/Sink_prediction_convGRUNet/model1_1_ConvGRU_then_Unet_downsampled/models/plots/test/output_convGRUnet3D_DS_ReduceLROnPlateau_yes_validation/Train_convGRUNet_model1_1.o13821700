Available device: cpu 
Loading images!
Total set size: 2000, Training set size: 1980, Test set size: 20, validation set: 136, 
Time taken to load images: 19.44 seconds
convGRUnet3D_DS_ReduceLROnPlateau_yes_validation Starting training!
Training convGRUNet with 1980 samples, convGRUnet3D_DS_ReduceLROnPlateau_yes_validation run
Using 8 DataLoader workers
Model initialized for training with 2,141,784 trainable parameters.
/home/x-nbisht1/.local/lib/python3.9/site-packages/torch/utils/data/dataloader.py:665: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
  warnings.warn(warn_msg)
Epoch 1: Total=1.8504 | L1=1.4236 HighDensity=0.0164 Mass=0.0138  Hist=0.0064 Spectral=0.3902 LR=(0.001,) Weights: (1.0, 1.0, 1.0, 1.0, 1.0)
Validation! Epoch 1: Total=1.4955 | L1=1.1829 HighDensity=0.0144 Mass=0.0114  Hist=0.0066 Spectral=0.2802 LR=(0.001,) Weights: (1.0, 1.0, 1.0, 1.0, 1.0)
Epoch 2: Total=1.3364 | L1=1.0401 HighDensity=0.0141 Mass=0.0058  Hist=0.0035 Spectral=0.2729 LR=(0.001,) Weights: (1.0, 1.0, 1.0, 1.0, 1.0)
Epoch 3: Total=1.0934 | L1=0.8660 HighDensity=0.0122 Mass=0.0048  Hist=0.0030 Spectral=0.2074 LR=(0.001,) Weights: (1.0372595727919014, 0.9440831844978225, 0.8901865937068664, 1.0211790971061665, 1.1072915518972435)
Epoch 4: Total=0.9587 | L1=0.7510 HighDensity=0.0110 Mass=0.0051  Hist=0.0027 Spectral=0.1571 LR=(0.001,) Weights: (1.0017076748869251, 1.0167111913387812, 0.9981593674845943, 0.9660126996808788, 1.0174090666088205)
Epoch 5: Total=0.8165 | L1=0.6754 HighDensity=0.0102 Mass=0.0047  Hist=0.0026 Spectral=0.1265 LR=(0.001,) Weights: (0.9849340901834378, 0.9972574168430318, 1.084068619470763, 0.9324089606631383, 1.0013309128396293)
Epoch 6: Total=0.7316 | L1=0.6222 HighDensity=0.0095 Mass=0.0053  Hist=0.0026 Spectral=0.1083 LR=(0.001,) Weights: (0.9976452952564863, 1.0353361057413941, 1.0045415258658392, 0.9518284062199187, 1.0106486669163617)
Validation! Epoch 6: Total=0.7672 | L1=0.6507 HighDensity=0.0090 Mass=0.0098  Hist=0.0057 Spectral=0.0979 LR=(0.001,) Weights: (0.9976452952564863, 1.0353361057413941, 1.0045415258658392, 0.9518284062199187, 1.0106486669163617)
Epoch 7: Total=0.6840 | L1=0.5786 HighDensity=0.0091 Mass=0.0044  Hist=0.0026 Spectral=0.0950 LR=(0.001,) Weights: (0.9762100930644726, 1.012120388526048, 1.0820831225430465, 0.944823864304146, 0.9847625315622869)
Epoch 8: Total=0.6323 | L1=0.5482 HighDensity=0.0089 Mass=0.0048  Hist=0.0025 Spectral=0.0853 LR=(0.001,) Weights: (1.0048576826031064, 1.038029130385654, 0.9634336704938905, 0.9784792487094585, 1.015200267807891)
Epoch 9: Total=0.6109 | L1=0.5170 HighDensity=0.0085 Mass=0.0050  Hist=0.0024 Spectral=0.0771 LR=(0.001,) Weights: (0.9849280322403772, 1.0005869967748393, 1.0516466479388222, 0.9613016615564011, 1.00153666148956)
Epoch 10: Total=0.5729 | L1=0.4963 HighDensity=0.0082 Mass=0.0049  Hist=0.0024 Spectral=0.0710 LR=(0.001,) Weights: (0.9926747157701551, 0.9925169824816678, 1.041416505586028, 0.973167450706197, 1.0002243454559523)
Epoch 11: Total=0.5518 | L1=0.4760 HighDensity=0.0080 Mass=0.0045  Hist=0.0024 Spectral=0.0660 LR=(0.001,) Weights: (0.9941392997559858, 1.0266818698654958, 1.0063231467709708, 0.9750632160814567, 0.9977924675260912)
Validation! Epoch 11: Total=0.6095 | L1=0.5242 HighDensity=0.0077 Mass=0.0116  Hist=0.0051 Spectral=0.0654 LR=(0.001,) Weights: (0.9941392997559858, 1.0266818698654958, 1.0063231467709708, 0.9750632160814567, 0.9977924675260912)
Epoch 12: Total=0.5271 | L1=0.4551 HighDensity=0.0080 Mass=0.0047  Hist=0.0023 Spectral=0.0611 LR=(0.001,) Weights: (1.0040579748379417, 1.007415884464498, 0.9880566267744467, 0.9894788674143687, 1.010990646508745)
Epoch 13: Total=0.5201 | L1=0.4459 HighDensity=0.0078 Mass=0.0047  Hist=0.0024 Spectral=0.0580 LR=(0.001,) Weights: (0.9881122848559856, 1.0063429878480248, 1.023477160012044, 0.9730276550017549, 1.0090399122821907)
Epoch 14: Total=0.4949 | L1=0.4321 HighDensity=0.0076 Mass=0.0050  Hist=0.0023 Spectral=0.0544 LR=(0.001,) Weights: (0.996502975536493, 1.020304829682153, 1.005049250040265, 0.9817282444001633, 0.9964147003409262)
Epoch 15: Total=0.4853 | L1=0.4216 HighDensity=0.0076 Mass=0.0046  Hist=0.0023 Spectral=0.0516 LR=(0.001,) Weights: (0.9932631376663155, 0.9861945017500126, 1.0496853754832836, 0.9771805008344081, 0.9936764842659805)
Epoch 16: Total=0.4716 | L1=0.4115 HighDensity=0.0074 Mass=0.0047  Hist=0.0023 Spectral=0.0493 LR=(0.001,) Weights: (1.0043309820386028, 1.0130591307159573, 0.9757333947442312, 0.9912037222338053, 1.0156727702674033)
Validation! Epoch 16: Total=0.5821 | L1=0.4993 HighDensity=0.0077 Mass=0.0120  Hist=0.0054 Spectral=0.0561 LR=(0.001,) Weights: (1.0043309820386028, 1.0130591307159573, 0.9757333947442312, 0.9912037222338053, 1.0156727702674033)
Epoch 17: Total=0.4671 | L1=0.4041 HighDensity=0.0073 Mass=0.0046  Hist=0.0023 Spectral=0.0473 LR=(0.001,) Weights: (0.9940035510469885, 1.006002037072001, 1.020297701621157, 0.9835372861382026, 0.9961594241216516)
Epoch 18: Total=0.4500 | L1=0.3924 HighDensity=0.0073 Mass=0.0056  Hist=0.0023 Spectral=0.0453 LR=(0.001,) Weights: (0.9993444786042351, 1.015974064663914, 0.9972103747878189, 0.9885801219011122, 0.99889096004292)
Epoch 19: Total=0.4454 | L1=0.3873 HighDensity=0.0073 Mass=0.0052  Hist=0.0022 Spectral=0.0441 LR=(0.001,) Weights: (0.9719389490338082, 0.9781222286030635, 1.0989460649909937, 0.9653292930751212, 0.9856634642970129)
Epoch 20: Total=0.4251 | L1=0.3805 HighDensity=0.0071 Mass=0.0049  Hist=0.0023 Spectral=0.0421 LR=(0.001,) Weights: (1.0078649078313306, 1.0003604098750496, 0.9748535782056738, 1.0005187702817286, 1.016402333806217)
Epoch 21: Total=0.4343 | L1=0.3757 HighDensity=0.0071 Mass=0.0048  Hist=0.0022 Spectral=0.0415 LR=(0.001,) Weights: (1.0028559037211522, 1.0235367638440798, 0.9852121523530069, 0.9894839524666237, 0.9989112276151372)
Validation! Epoch 21: Total=0.5176 | L1=0.4483 HighDensity=0.0069 Mass=0.0112  Hist=0.0052 Spectral=0.0452 LR=(0.001,) Weights: (1.0028559037211522, 1.0235367638440798, 0.9852121523530069, 0.9894839524666237, 0.9989112276151372)
Epoch 22: Total=0.4319 | L1=0.3764 HighDensity=0.0070 Mass=0.0051  Hist=0.0022 Spectral=0.0405 LR=(0.001,) Weights: (1.001624918997878, 1.0010780803101635, 0.9929400828979704, 1.0006880703765637, 1.003668847417425)
Epoch 23: Total=0.4188 | L1=0.3654 HighDensity=0.0071 Mass=0.0049  Hist=0.0022 Spectral=0.0386 LR=(0.001,) Weights: (0.9972181480503638, 0.9946865207629467, 1.0290810923969902, 0.9848637527290038, 0.9941504860606944)
Epoch 24: Total=0.4168 | L1=0.3658 HighDensity=0.0071 Mass=0.0049  Hist=0.0022 Spectral=0.0383 LR=(0.001,) Weights: (0.9968718793050266, 1.009353025376014, 0.9939092611814656, 0.9870777953804034, 1.0127880387570902)
Epoch 25: Total=0.4069 | L1=0.3580 HighDensity=0.0068 Mass=0.0047  Hist=0.0023 Spectral=0.0366 LR=(0.001,) Weights: (1.00099544315665, 0.9913438168835668, 1.0054030806956933, 0.9967642239314316, 1.0054934353326581)
Epoch 26: Total=0.4047 | L1=0.3542 HighDensity=0.0069 Mass=0.0051  Hist=0.0023 Spectral=0.0360 LR=(0.001,) Weights: (1.0005227890406074, 1.0310580755400773, 0.9909880319141832, 0.9898507906318218, 0.9875803128733098)
Validation! Epoch 26: Total=0.4934 | L1=0.4296 HighDensity=0.0070 Mass=0.0115  Hist=0.0051 Spectral=0.0404 LR=(0.001,) Weights: (1.0005227890406074, 1.0310580755400773, 0.9909880319141832, 0.9898507906318218, 0.9875803128733098)
Epoch 27: Total=0.4030 | L1=0.3539 HighDensity=0.0068 Mass=0.0049  Hist=0.0022 Spectral=0.0354 LR=(0.001,) Weights: (0.9888639649511508, 0.9940402083614156, 1.0292225957088166, 0.9862351242763845, 1.0016381067022324)
Epoch 28: Total=0.3932 | L1=0.3488 HighDensity=0.0067 Mass=0.0050  Hist=0.0022 Spectral=0.0347 LR=(0.001,) Weights: (1.0082107320723857, 0.9991016609495358, 0.9880292137929253, 1.000046408350619, 1.0046119848345345)
Epoch 29: Total=0.4012 | L1=0.3498 HighDensity=0.0070 Mass=0.0046  Hist=0.0021 Spectral=0.0347 LR=(0.001,) Weights: (0.9950007542929521, 1.0070064748442715, 1.0114781121969136, 0.9919325357565677, 0.9945821229092955)
Epoch 30: Total=0.3920 | L1=0.3467 HighDensity=0.0068 Mass=0.0048  Hist=0.0022 Spectral=0.0334 LR=(0.001,) Weights: (1.0083427913527796, 0.983440557949194, 0.9714458039868775, 1.0069312751084198, 1.0298395716027284)
Epoch 31: Total=0.3964 | L1=0.3459 HighDensity=0.0068 Mass=0.0053  Hist=0.0023 Spectral=0.0330 LR=(0.001,) Weights: (0.9953940704314425, 1.018468447467807, 1.0183049371790327, 0.9819190815685542, 0.9859134633531627)
Validation! Epoch 31: Total=0.4867 | L1=0.4246 HighDensity=0.0077 Mass=0.0109  Hist=0.0050 Spectral=0.0410 LR=(0.001,) Weights: (0.9953940704314425, 1.018468447467807, 1.0183049371790327, 0.9819190815685542, 0.9859134633531627)
Epoch 32: Total=0.3862 | L1=0.3412 HighDensity=0.0067 Mass=0.0050  Hist=0.0022 Spectral=0.0333 LR=(0.001,) Weights: (0.9872632377429567, 0.9964043326712669, 1.0496379668677067, 0.9817422463206392, 0.9849522163974307)
Epoch 33: Total=0.3808 | L1=0.3396 HighDensity=0.0069 Mass=0.0044  Hist=0.0022 Spectral=0.0325 LR=(0.001,) Weights: (1.0034367357042608, 0.9946434770057051, 0.9803268908447501, 1.0146597421459183, 1.0069331542993654)
Epoch 34: Total=0.3811 | L1=0.3343 HighDensity=0.0069 Mass=0.0045  Hist=0.0021 Spectral=0.0316 LR=(0.001,) Weights: (1.0106004858452093, 1.0143755888385444, 0.9488810986435723, 1.0013089889805438, 1.0248338376921302)
Epoch 35: Total=0.3847 | L1=0.3355 HighDensity=0.0068 Mass=0.0049  Hist=0.0022 Spectral=0.0317 LR=(0.001,) Weights: (0.9950908753044504, 0.989249864544353, 1.0231968619858187, 0.9887481835631013, 1.0037142146022768)
Epoch 36: Total=0.3765 | L1=0.3337 HighDensity=0.0066 Mass=0.0051  Hist=0.0022 Spectral=0.0307 LR=(0.001,) Weights: (0.9892623092750539, 1.012464244504077, 1.0320151515137699, 0.9894262607445937, 0.9768320339625061)
Validation! Epoch 36: Total=0.4853 | L1=0.4243 HighDensity=0.0085 Mass=0.0116  Hist=0.0052 Spectral=0.0403 LR=(0.001,) Weights: (0.9892623092750539, 1.012464244504077, 1.0320151515137699, 0.9894262607445937, 0.9768320339625061)
Epoch 37: Total=0.3723 | L1=0.3312 HighDensity=0.0067 Mass=0.0052  Hist=0.0022 Spectral=0.0309 LR=(0.001,) Weights: (1.001032110182415, 1.0011791822441782, 1.0155863262101121, 0.9883555738648594, 0.9938468074984355)
Epoch 38: Total=0.3756 | L1=0.3303 HighDensity=0.0068 Mass=0.0054  Hist=0.0022 Spectral=0.0308 LR=(0.001,) Weights: (0.9947979915350796, 0.9877356062126934, 1.0145400216170544, 1.0009327959398193, 1.0019935846953532)
Epoch 39: Total=0.3774 | L1=0.3340 HighDensity=0.0069 Mass=0.0053  Hist=0.0022 Spectral=0.0307 LR=(0.001,) Weights: (0.9918256061299376, 1.0106507030972658, 1.0066892857790977, 0.9924610693173505, 0.9983733356763481)
Epoch 40: Total=0.3689 | L1=0.3277 HighDensity=0.0066 Mass=0.0050  Hist=0.0022 Spectral=0.0301 LR=(0.001,) Weights: (1.0056650621594734, 0.9932748779981929, 0.9936518129734754, 0.9971324651646747, 1.010275781704184)
Epoch 41: Total=0.3766 | L1=0.3305 HighDensity=0.0067 Mass=0.0052  Hist=0.0023 Spectral=0.0301 LR=(0.001,) Weights: (1.0031011501379372, 1.0127575470905406, 0.9856434924199621, 1.0041453763292996, 0.994352434022261)
Validation! Epoch 41: Total=0.4796 | L1=0.4192 HighDensity=0.0079 Mass=0.0107  Hist=0.0051 Spectral=0.0354 LR=(0.001,) Weights: (1.0031011501379372, 1.0127575470905406, 0.9856434924199621, 1.0041453763292996, 0.994352434022261)
Epoch 42: Total=0.3658 | L1=0.3215 HighDensity=0.0067 Mass=0.0050  Hist=0.0022 Spectral=0.0294 LR=(0.001,) Weights: (0.9971318759126319, 1.001775050908816, 1.0142066514236838, 0.9928743334590628, 0.9940120882958049)
Epoch 43: Total=0.3651 | L1=0.3236 HighDensity=0.0067 Mass=0.0048  Hist=0.0022 Spectral=0.0289 LR=(0.001,) Weights: (0.9994198588433029, 0.9994055634227402, 0.9878687344994516, 1.0001185265525905, 1.0131873166819148)
Epoch 44: Total=0.3624 | L1=0.3203 HighDensity=0.0066 Mass=0.0049  Hist=0.0021 Spectral=0.0286 LR=(0.001,) Weights: (1.0075487218392685, 1.0014926096707049, 0.9858967159436874, 0.99642427979, 1.0086376727563395)
Epoch 45: Total=0.3648 | L1=0.3205 HighDensity=0.0064 Mass=0.0050  Hist=0.0022 Spectral=0.0283 LR=(0.001,) Weights: (0.99674452345589, 0.991984419947524, 1.0178920861123824, 0.9972052492325295, 0.996173721251674)
Epoch 46: Total=0.3593 | L1=0.3182 HighDensity=0.0067 Mass=0.0048  Hist=0.0022 Spectral=0.0284 LR=(0.001,) Weights: (0.9988867344608613, 1.0216244230243006, 1.0029984304472253, 0.9928134987086489, 0.9836769133589646)
Validation! Epoch 46: Total=0.4833 | L1=0.4222 HighDensity=0.0074 Mass=0.0121  Hist=0.0055 Spectral=0.0368 LR=(0.001,) Weights: (0.9988867344608613, 1.0216244230243006, 1.0029984304472253, 0.9928134987086489, 0.9836769133589646)
Epoch 47: Total=0.3606 | L1=0.3194 HighDensity=0.0065 Mass=0.0052  Hist=0.0022 Spectral=0.0279 LR=(0.001,) Weights: (0.996835127079131, 0.9963086973964469, 0.9860425369379826, 1.0022088665781013, 1.0186047720083382)
Epoch 48: Total=0.3618 | L1=0.3203 HighDensity=0.0067 Mass=0.0052  Hist=0.0022 Spectral=0.0283 LR=(0.001,) Weights: (0.9959752832241866, 0.9998899389638131, 1.0380681616174434, 0.9852721556097824, 0.9807944605847738)
Epoch 49: Total=0.3536 | L1=0.3145 HighDensity=0.0064 Mass=0.0048  Hist=0.0021 Spectral=0.0274 LR=(0.001,) Weights: (0.9999213676162348, 0.9874780741620778, 0.9953514485774393, 1.0057314176398193, 1.0115176920044289)
Epoch 50: Total=0.3593 | L1=0.3176 HighDensity=0.0064 Mass=0.0050  Hist=0.0022 Spectral=0.0279 LR=(0.001,) Weights: (1.012528421338975, 0.9945541538792153, 0.9851655764839, 1.004798366959082, 1.0029534813388283)
convGRUnet3D_DS_ReduceLROnPlateau_yes_validation Training completed!
Time taken for training convGRUnet3D_DS_ReduceLROnPlateau_yes_validation: 6462.78 seconds
Model loaded with 2,141,784 trainable parameters.
/home/x-nbisht1/.local/lib/python3.9/site-packages/skimage/metrics/simple_metrics.py:168: RuntimeWarning: divide by zero encountered in scalar divide
  return 10 * np.log10((data_range**2) / err)
Model: convGRUnet3D_DS_ReduceLROnPlateau_yes_validation Avg Test MSE: 0.0022, Avg Test Density Difference: 366.5535
Model: convGRUnet3D_DS_ReduceLROnPlateau_yes_validation Testing completed!
Loading u502 images!
Model loaded with 2,141,784 trainable parameters.
Testing completed and output images plotted.
[0.30188048 0.00528652 0.         0.57421955 0.015625  ]
Model: convGRUnet3D_DS_ReduceLROnPlateau_yes_validation Diffsim Testing completed!
